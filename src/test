Perfect üëç
Below is a **much simpler, final Confluence-ready version**, trimmed to **only what matters**, updated with:

* ‚úÖ **TIO** terminology
* ‚úÖ **AWS self-hosted runner only**
* ‚úÖ **Node 20.12.1**
* ‚úÖ **Allure reports**
* ‚úÖ No heavy/advanced scenarios

I‚Äôve clearly marked **where the document starts and ends**.

---

---

# üìÑ CONFLUENCE DOCUMENT STARTS HERE

---

# Playwright Automation ‚Äì CI/CD Setup (GitHub Actions + AWS)

## 1. Purpose

This document explains **exactly what the TIO team needs to set up** so our existing **Playwright automation framework** can run in a **CI/CD pipeline** using **GitHub Actions** and **AWS**.

Currently, tests run locally. After this setup:

* Tests can be triggered from GitHub
* Everyone runs tests the same way
* Reports are generated automatically (Allure)

---

## 2. High-Level Overview

**How it works**

1. GitHub Actions workflow is triggered (manual / PR / push)
2. Job runs on a **self-hosted GitHub runner**
3. Runner is hosted on **AWS EC2**
4. Playwright tests execute
5. **Allure report** is generated and uploaded

**Important**

* We are **not using GitHub-hosted runners**
* We are **using AWS EC2**

---

## 3. AWS Setup (What TIO Needs to Create)

### 3.1 EC2 Instance

**Recommended**

* OS: Ubuntu 22.04
* Instance type: `t3.small` or `t3.medium`
* Disk: 30 GB
* Network: Access to application under test
* No inbound ports required (preferred)

---

## 4. Software Installation on EC2

### 4.1 System Packages

```bash
sudo apt update
sudo apt install -y curl unzip git
```

### 4.2 Node.js (Required Version)

**Node version: `20.12.1`**

```bash
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt install -y nodejs
```

Verify:

```bash
node -v   # should be 20.12.1
npm -v
```

---

## 5. GitHub Self-Hosted Runner Setup

### 5.1 Register Runner

1. GitHub Repo ‚Üí Settings ‚Üí Actions ‚Üí Runners
2. Add **New self-hosted runner**
3. Choose **Linux**
4. Follow GitHub instructions on the EC2 instance

### 5.2 Required Runner Labels

Add these labels:

* `self-hosted`
* `linux`
* `playwright`
* `aws`

### 5.3 Run Runner as a Service

```bash
sudo ./svc.sh install
sudo ./svc.sh start
```

---

## 6. Commands Used by CI (Important for TIO)

The CI pipeline runs **only these commands**:

```bash
npm ci
npx playwright install --with-deps
npx playwright test
```

No extra setup is required.

---

## 7. Secrets & Environment Variables

TIO must configure **GitHub Secrets**:

Examples:

* `BASE_URL`
* `USERNAME`
* `PASSWORD`
* Any required API tokens

Secrets must be added in:

* GitHub ‚Üí Repository Settings ‚Üí Secrets
  (or GitHub Environments if used)

---

## 8. GitHub Actions Workflow (Final & Simple)

Create file:

```
.github/workflows/playwright.yml
```

```yaml
name: Playwright Tests

on:
  workflow_dispatch:
  pull_request:
  push:
    branches: [ main ]

jobs:
  playwright:
    runs-on: [self-hosted, linux, playwright, aws]
    timeout-minutes: 30

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 20.12.1

      - name: Install dependencies
        run: npm ci

      - name: Install Playwright browsers
        run: npx playwright install --with-deps

      - name: Run Playwright tests
        run: npx playwright test

      - name: Generate Allure report
        if: always()
        run: |
          npx allure generate allure-results --clean -o allure-report

      - name: Upload Allure report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: allure-report
          path: allure-report/
          retention-days: 14
```

---

## 9. Test Reports

After each run:

* **Allure report** is available as a GitHub Actions artifact
* Can be downloaded and opened locally (`index.html`)

---

## 10. Responsibilities

### Engineering

* Maintain Playwright tests
* Maintain Allure configuration
* Ensure tests run headless

### TIO

* Provision AWS EC2
* Install Node and system dependencies
* Configure GitHub self-hosted runner
* Maintain runner health
* Configure secrets

---

## 11. Summary (For Quick Reading)

* AWS EC2 is required
* GitHub Actions uses self-hosted runner
* Node version: **20.12.1**
* Playwright installs its own browsers
* Allure reports are generated automatically
* TIO owns infrastructure, Engineering owns tests

---

# üìÑ CONFLUENCE DOCUMENT ENDS HERE

---

If you want, I can:

* Make this **even shorter (¬Ω page)**
* Add a **simple architecture diagram**
* Rewrite it in **TIO checklist format**
* Align wording exactly with your internal Confluence style

Just tell me üëç
